# C/C++ 定宽整数类型详解：uint8_t 及其家族

## 1. 定宽整数类型概述

定宽整数类型（Fixed-width integer types）是C99和C++11引入的一组数据类型，它们明确指定了存储的位数，提供了跨平台的一致性保证。这些类型定义在`<cstdint>`（C++）或`<stdint.h>`（C）头文件中。

## 2. uint8_t 类型详解

### 定义
`uint8_t` 是一个无符号8位整数类型，正好占用1个字节（8位）内存空间。

### 特性
- **无符号性**：只能表示非负整数
- **固定宽度**：保证在任何平台上都是8位
- **取值范围**：0 到 255 (2⁸-1)
- **内存占用**：1字节（8位）

### 使用场景
- 处理原始二进制数据
- 网络协议实现
- 图像处理（如像素值）
- 内存敏感的应用

### 声明与初始化
```cpp
#include <cstdint>

uint8_t byte = 42;      // 十进制初始化
uint8_t mask = 0xFF;    // 十六进制初始化
uint8_t flags = 0b1010; // 二进制初始化（C++14起）
```

## 3. 相关类型家族

### 3.1 无符号类型
| 类型        | 位数 | 最小值 | 最大值       | 等价于         |
|-------------|------|--------|--------------|----------------|
| uint8_t     | 8    | 0      | 255          | unsigned char  |
| uint16_t    | 16   | 0      | 65,535       | unsigned short |
| uint32_t    | 32   | 0      | 4,294,967,295| unsigned int   |
| uint64_t    | 64   | 0      | 18,446,744,073,709,551,615 | unsigned long long |

### 3.2 有符号类型
| 类型        | 位数 | 最小值               | 最大值              | 等价于         |
|-------------|------|----------------------|---------------------|----------------|
| int8_t      | 8    | -128                 | 127                 | signed char    |
| int16_t     | 16   | -32,768              | 32,767              | short          |
| int32_t     | 32   | -2,147,483,648       | 2,147,483,647       | int            |
| int64_t     | 64   | -9,223,372,036,854,775,808 | 9,223,372,036,854,775,807 | long long |

### 3.3 快速类型
`uint_fast8_t`等类型会选择至少指定位数但处理速度最快的类型。

### 3.4 最小宽度类型
`uint_least8_t`等类型保证至少有指定位数，可能更多。

## 4. 极限值定义

所有定宽整数类型的极限值都定义在`<cstdint>`中：

```cpp
// 无符号类型最大值
#define UINT8_MAX     255
#define UINT16_MAX    65535
#define UINT32_MAX    4294967295U
#define UINT64_MAX    18446744073709551615ULL

// 有符号类型极值
#define INT8_MIN     -128
#define INT8_MAX     127
#define INT16_MIN    -32768
#define INT16_MAX    32767
#define INT32_MIN    (-2147483647-1)
#define INT32_MAX    2147483647
#define INT64_MIN    (-9223372036854775807LL-1)
#define INT64_MAX    9223372036854775807LL
```

## 5. 使用注意事项

1. **平台兼容性**：虽然这些类型在大多数现代平台都可用，但某些嵌入式平台可能不支持64位类型
2. **打印格式化**：
   ```cpp
   uint8_t byte = 100;
   printf("%u", byte);  // 需要提升为unsigned int
   std::cout << +byte;  // +操作符提升为int
   ```
3. **类型转换**：小心隐式转换导致的数值截断
4. **与char的关系**：`uint8_t`通常等同于`unsigned char`，但语义不同

## 6. 为什么使用定宽整数类型

1. **可移植性**：在不同平台上保持相同大小
2. **明确性**：代码明确表达数据的大小需求
3. **二进制兼容性**：网络传输和文件存储时确保数据布局一致
4. **性能优化**：选择最适合硬件的数据大小

## 7. 示例代码

```cpp
#include <iostream>
#include <cstdint>
#include <climits>

int main() {
    uint8_t small = 255;
    uint16_t medium = 65535;
    uint32_t large = 4294967295;
    uint64_t huge = UINT64_MAX;
    
    std::cout << "uint8_t max: " << +small << "\n";  // 输出255
    std::cout << "uint16_t max: " << medium << "\n"; // 输出65535
    std::cout << "uint32_t max: " << large << "\n";  // 输出4294967295
    std::cout << "uint64_t max: " << huge << "\n";   // 输出18446744073709551615
    
    // 溢出示例
    small += 1;  // 溢出，变为0
    std::cout << "Overflowed uint8_t: " << +small << "\n";
    
    return 0;
}
```
