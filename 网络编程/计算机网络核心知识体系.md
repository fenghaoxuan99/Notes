

# **计算机网络核心知识体系**
#### **一、网络分层模型**
1. **OSI七层模型**
   | 层级       | 核心功能                    | 关键设备/协议       |
   |-----------|---------------------------|-------------------|
   | 物理层     | 比特流传输（数模转换）         | 网卡、光纤         |
   | 数据链路层  | 帧传输、错误检测（MAC地址寻址） | 交换机、ARP、PPP   |
   | 网络层     | 路由选择、IP寻址              | 路由器、IP、ICMP   |
   | 传输层     | 端到端连接、可靠性控制         | TCP、UDP          |
   | 会话层     | 建立/断开连接                | RPC               |
   | 表示层     | 数据格式转换（加密/压缩）      | SSL/TLS、ASCII    |
   | 应用层     | 应用程序接口                 | HTTP、FTP、DNS     |

   > **补充说明**：数据单元在各层的名称：
   > - 传输层：段（Segments）
   > - 网络层：包（Packages）
   > - 数据链路层：帧（Frames）
   > - 物理层：比特流（Bits）

2. **TCP/IP四层模型**
   ```mermaid
   graph LR
   A[应用层] -->|HTTP/FTP/DNS| B[传输层]
   B -->|TCP/UDP| C[网络层]
   C -->|IP/ICMP| D[网络接口层]
   ```
   - **核心差异**：OSI理论导向，TCP/IP实践导向。

---

#### **二、关键网络设备**
| 设备     | 工作层级       | 核心功能                          | 寻址依据      |
|----------|----------------|-----------------------------------|---------------|
| 交换机   | 数据链路层     | 局域网内MAC地址转发               | MAC地址表     |
| 路由器   | 网络层         | 跨网络IP路由选择                  | IP路由表      |

> **补充说明**：路由器通过IP网络号实现跨网络通信，解决交换机MAC表容量限制问题。

---

#### **三、HTTP协议**
1. **请求方法**
   - 安全方法（幂等）：`GET`、`HEAD`、`OPTIONS`
   - 非安全方法：`POST`（创建）、`PUT`（全量更新）、`PATCH`（局部更新）、`DELETE`
   - `GET` vs `POST`：
     - `GET`参数在URL，长度受限（约2083字符），可缓存
     - `POST`数据在Body，无长度限制，不幂等

2. **状态码**
   | 分类 | 含义          | 常见状态码                         |
   |------|---------------|------------------------------------|
   | 2xx  | 成功          | 200 OK、204 No Content             |
   | 3xx  | 重定向        | 301（永久）、302（临时）、304（缓存） |
   | 4xx  | 客户端错误    | 400 Bad Request、403 Forbidden     |
   | 5xx  | 服务器错误    | 500 Internal Error、504 Gateway Timeout |

3. **HTTP版本演进**
   | 版本   | 核心改进                                      | 解决的问题               |
   |--------|---------------------------------------------|--------------------------|
   | 1.1    | 长连接、管道传输、Host头                     | 连接复用效率低           |
   | 2.0    | 二进制帧、多路复用、头部压缩、服务器推送     | 队头阻塞                 |
   | 3.0    | 基于QUIC（UDP）、0-RTT连接                  | TCP队头阻塞、握手延迟    |

---

#### **四、TCP vs UDP**
| 特性         | TCP                            | UDP                          |
|--------------|--------------------------------|------------------------------|
| 连接性       | 面向连接（三次握手）           | 无连接                       |
| 可靠性       | 确认重传、流量控制、拥塞控制   | 尽最大努力交付               |
| 数据单元     | 字节流（可能粘包）             | 数据报文（有边界）           |
| 速度         | 慢（需建立连接/确认）          | 快（无连接/无确认）          |
| 应用场景     | 网页、邮件、文件传输           | 视频流、DNS、实时游戏        |

**关键机制**：
1. **TCP三次握手**
   ```mermaid
   sequenceDiagram
   客户端->>服务端： SYN=1, seq=x
   服务端->>客户端： SYN=1, ACK=1, seq=y, ack=x+1
   客户端->>服务端： ACK=1, seq=x+1, ack=y+1
   ```
   > 目的：同步初始序列号，防止历史连接问题。

2. **TCP四次挥手**
   ```mermaid
   sequenceDiagram
   客户端->>服务端： FIN=1, seq=u
   服务端->>客户端： ACK=1, seq=v, ack=u+1
   服务端->>客户端： FIN=1, ACK=1, seq=w, ack=u+1
   客户端->>服务端： ACK=1, seq=u+1, ack=w+1
   ```
   > `TIME_WAIT`作用：确保最后一个ACK到达 + 让旧报文过期（等待2MSL）。

3. **拥塞控制**
   ```mermaid
   graph LR
   A[慢启动] -->|cwnd < ssthresh| B[指数增长]
   B -->|cwnd >= ssthresh| C[拥塞避免-线性增长]
   C -->|丢包| D[快重传/快恢复]
   D -->|重设ssthresh| C
   ```

---

#### **五、HTTPS安全机制**
**工作流程**：
```mermaid
sequenceDiagram
客户端->>服务端： 请求HTTPS连接
服务端->>客户端： 发送数字证书
客户端->>CA： 验证证书有效性
客户端->>服务端： 用证书公钥加密对称密钥
服务端->>客户端： 用私钥解密后，用对称密钥通信
```
> **数字证书作用**：验证服务器身份，防止中间人攻击。

---

#### **六、网络安全**
1. **XSS vs CSRF**
   | 攻击类型 | 原理                   | 防御方法                     |
   |----------|----------------------|------------------------------|
   | XSS      | 注入恶意脚本到页面      | 输入过滤、CSP、转义HTML      |
   | CSRF     | 伪造用户身份执行操作    | Anti-CSRF Token、验证Referer |

2. **DDoS攻击**
   - **SYN Flood原理**：伪造大量SYN请求耗尽服务器连接资源。
   - **防御**：限流、SYN Cookie、Web应用防火墙（WAF）。

---

#### **七、其他核心概念**
1. **DNS解析过程**
   ```mermaid
   graph LR
   A[浏览器缓存] --> B[系统缓存] --> C[路由器缓存] 
   C --> D[ISP DNS] --> E[根域名服务器] --> F[顶级域名服务器]
   ```

2. **子网划分**
   - **公式**：子网可用IP数 = \(2^{\text{主机位}} - 2\)
   - **示例**：`192.168.1.0/24` 划分4个子网 → 掩码`255.255.255.192`

3. **Socket**
   - **本质**：应用层与TCP/IP协议族的编程接口（API）
   - **通信流程**：创建Socket → 绑定端口 → 监听 → 接受连接 → 数据传输