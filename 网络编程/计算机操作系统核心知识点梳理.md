

# **计算机操作系统核心知识点梳理**

#### **一、计算机结构（冯·诺依曼模型）**
1. **五大核心组件**：
   - **控制器**：计算机中枢神经，解释指令并协调各部件工作。
   - **运算器**：执行算术和逻辑运算。
   - **存储器**：存储程序、数据及指令。
   - **输入设备**（如键盘、鼠标）：向计算机输入数据。
   - **输出设备**（如显示器、打印机）：输出处理结果。

2. **内存管理**：
   - 内存按线性地址排列，最小单位是字节（8位）。
   - 随机存取存储器（RAM）：读写任意地址速度相同。
   - **虚拟内存**：扩展物理内存，将硬盘空间作为辅助存储（详见内存管理部分）。

---

#### **二、CPU与执行流程**
1. **CPU核心组件**：
   - **位宽**：32位CPU每次处理4字节，64位处理8字节。
   - **寄存器**：高速存储单元（如通用寄存器、程序计数器PC、指令寄存器IR）。
   - **多级缓存**（速度递减）：
     - L1缓存：CPU核心内，速度最快（2~4时钟周期）。
     - L2缓存：CPU内，速度次之（10~20周期）。
     - L3缓存：CPU共享，容量最大（20~60周期）。

2. **程序执行流程**：
   ```mermaid
   graph LR
   A[读取PC指向的指令] --> B[存入指令寄存器]
   B --> C[分析指令类型]
   C --> D{计算指令？}
   D -->|是| E[逻辑单元运算]
   D -->|否| F[控制单元执行]
   E/F --> G[PC自增指向下条指令]
   ```

---

#### **三、进程与线程**
1. **进程**：
   - **定义**：资源分配的最小单位，拥有独立内存空间。
   - **状态转换**：
     - 创建 → 就绪 → 运行 → 阻塞 → 终止
   - **进程间通信（IPC）**：
     - **管道**：半双工，仅限亲缘进程（如父子进程）。
     - **消息队列**：内核中的链表，异步通信。
     - **共享内存**：最快IPC方式，需同步机制（如信号量）。
     - **信号**：异步通知（如`SIGKILL`终止进程）。

2. **线程**：
   - **定义**：CPU调度的基本单位，共享进程资源。
   - **类型**：
     - **用户态线程**：创建成本低，无法利用多核。
     - **内核态线程**：由OS管理，可多核并行，切换成本高。
   - **协程**：用户态轻量级线程，无切换开销，适合高并发。

3. **关键区别**：
   | **维度**       | **进程**             | **线程**         |
   |---------------|---------------------|------------------|
   | 资源开销       | 大（独立内存）         | 小（共享内存）     |
   | 通信方式       | IPC（管道、信号等）    | 直接读写共享内存    |
   | 多核利用       | 是                   | 是（内核态线程）    |

---

#### **四、内存管理**
1. **虚拟内存**：
   - **作用**：扩展物理内存，隔离进程地址空间。
   - **实现机制**：
     - **分页**：内存分为固定大小页（如4KB）。
     - **页表**：存储虚拟页到物理页的映射。
     - **TLB快表**：加速页表查询的硬件缓存。

2. **页面置换算法**：
   - **OPT**：淘汰未来最久不使用的页（理论最优）。
   - **LRU**：淘汰最近最久未使用的页（实践常用）。
   - **FIFO**：简单但易产生Belady异常。

3. **局部性原理**：
   - **时间局部性**：频繁访问相同数据（如循环变量）。
   - **空间局部性**：访问相邻内存（如数组遍历）。

---

#### **五、死锁与调度**
1. **死锁条件**（缺一不可）：
   - 互斥、占有且等待、不可抢占、循环等待。
   - **解决方案**：
     - **预防**：破坏任一条件（如一次性申请资源）。
     - **避免**：银行家算法（动态检查资源分配安全性）。

2. **进程调度算法**：
   - **时间片轮转**：公平但上下文切换开销大。
   - **多级反馈队列**：
     - 优先级高的队列时间片短（如紧急任务）。
     - 长任务降级至低优先级队列执行。

---

#### **六、设备管理**
- **磁盘调度算法**：
  - **SSTF**：最短寻道时间优先，可能饥饿。
  - **SCAN（电梯算法）**：单向移动服务请求，无饥饿问题。

---

#### **七、高频面试题**
1. **进程 vs 线程**：
   - 进程是资源分配单位，线程是CPU调度单位。
   - 线程共享进程资源，通信成本低。

2. **用户态 vs 内核态**：
   - **切换触发**：系统调用、异常、外设中断。
   - **区别**：内核态可执行特权指令（如I/O操作）。

3. **分页 vs 分段**：
   | **分页**          | **分段**             |
   |------------------|----------------------|
   | 页大小固定         | 段大小可变            |
   | 一维地址空间       | 二维地址空间（段号+偏移）|

4. **僵尸进程 vs 孤儿进程**：
   - **僵尸进程**：子进程退出后父进程未回收资源（`wait()`）。
   - **孤儿进程**：父进程先退出，由init进程接管。

