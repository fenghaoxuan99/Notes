# JPEG-LS 1PPC架构关键路径与流水线冲突示意图

```mermaid
%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#F5F5DC', 'edgeLabelBackground':'#FFF'}}}%%
graph TD
    subgraph 空间局部性统计
        A[3×3邻域内<br>相同q值概率 >52%]
    end

    subgraph RAW数据冒险时序
        B[周期1: 像素1处理] -->|"1. 读取C[q1](旧值)"| B1[梯度计算q1]
        B1 -->|"2. 更新C[q1](新值)"| B2[寄存器R1]
        C[周期2: 像素2处理<br>q2=q1] -->|"3. 需读取C[q1]"| B2
        B2 -.->|"4. 更新未完成"| C
        C -->|"插入气泡"| D[等待周期]
        D -->|"5. 读取C[q1](新值)"| E[周期3: 继续处理]
    end

    subgraph 关键路径延迟
        F[像素1] -->|T1| G[梯度计算1]
        G -->|T2| H[寄存器R1]
        I[像素2] -->|T1| J[梯度计算2]
        J -->|T2| H
        K[像素3] -->|T1| L[梯度计算3]
        L -->|T2| H
        M["T_crit = T1 + T2 + T3<br>f_max ≤ 1/(T1+T2+T3)"]
    end

    subgraph 冲突机制
        N[像素n] --> O[梯度计算qn]
        O --> P[上下文地址qn]
        P --> Q[读取C[qn]]
        Q -.-> R[更新C[qn]]
        R --> O
    end

    style A fill:#E6E6FA,stroke:#333
    style B fill:#E1F5FE,stroke:#039BE5
    style C fill:#FFEBEE,stroke:#E53935
    style D fill:#FFF9C4,stroke:#FDD835
    style F fill:#E8F5E9,stroke:#43A047
    style M fill:#F3E5F5,stroke:#8E24AA
    style N fill:#FFF3E0,stroke:#FB8C00
```